this version has the memory leak
I left this for you.
Hint is free can be use inside of for and the end of the algorithm.
And the most of leak is occured from the loading part if statments :-)
